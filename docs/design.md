# design

ほぼ適当！！

## function

- uiに遺伝子をランダムに返す
- idと評価値を貰って、gaをする

## architecture

- datastore
  - etcd
- lang
  - golang

## entity

### gene

- id
- parameter
- evaluation[]

### evaluation

- value
- user_name

## feature

- 遺伝子のクラスタリング
- 認証
- 評価引き継ぎをちゃんとする
- 交叉や戦略を選べる様にする

## 決めたい事

- 母集団どれくらい
  - とりあえず20
- 交叉したときの評価の引継ぎをどうするか
  - 元のやつに同じユーザが評価した物があればそれの平均、片方しかない場合はそのまま引き継ぐ
- 何交叉か
  - とりあえず一様交叉
- エリーと戦略とか
  - 使う
- 遺伝子の選出は
  - とりあえず適当
  - 評価値高いじゅんで下から20~50％くらい
- ユーザー毎に遺伝子分ける
  - とりあえず分けない
- 突然変異
  - 0.01%くらい

## gene更新シーケンス

- 全部の遺伝子をとる
- データとして受けとった評価値を反映
- 各遺伝子の評価値の合計を計算
- 下30%を捨てる
- 上位20%は残す
- 上位21~70%で交叉
  - 遺伝子の各パラメーターを2進数にする
  - 各パラメータのbitをどっちかから1/2の確率でひき継ぐ
- 突然変異
  - できた遺伝子の2進数状態のパラメータに対して0.01%くらいの確率でbit反転する
- 出来た遺伝子を保存する

## 必要な関数

- dbからgeneを全て取ってくる奴
- geneのevaluationを更新する奴
- geneの評価値を返す奴
- 残す遺伝子を決める奴
- 交叉
- geneの評価値を2進数で返す奴
- 任意の長さの2進数を受け取ってマージするやつ
- 任意の長さの2進数を受けとってbit反転する奴
- dbにgeneを保存する奴
